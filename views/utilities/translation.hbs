<form action="/logged/utilities/translation" method="POST">
    <textarea id="speech-text" name="text" cols="1" rows="1" style="display:none;"></textarea>
    <img onclick="startDictation()" witdh="200" height="200" src="https://assets.dryicons.com/uploads/icon/svg/6122/bef13daa-e9a2-4855-9552-5a274a59f119.svg"/>
    <input id="translate" type="submit" value="Translate"/>
</form>
<textarea id="translated" cols="100" rows="10" style="display:none;">{{ translated }}</textarea>
<script src="https://code.responsivevoice.org/responsivevoice.js?key=qNPkUHT3"></script>
<script>
    const $translate = document.getElementById('translates');
    {{#if speak}}
        const text = document.getElementById('translated').value;
        responsiveVoice.speak(text);    
    {{/if}}
    
</script>

<script>

    let lang = "pt-PT";
    function startDictation() {

        if (window.hasOwnProperty('webkitSpeechRecognition')) {

        var recognition = new webkitSpeechRecognition();

        recognition.continuous = false;
        recognition.interimResults = false;
    
        recognition.lang = lang;
        recognition.start();

        recognition.onresult = function(e) {
            const $speechT = document.getElementById("speech-text");
            $speechT.value = e.results[0][0].transcript;

            recognition.stop();
        };

        recognition.onerror = function(e) {
            recognition.stop();
        }

        }
    }


</script>
