
<form action="/logged/utilities/translation" method="POST" class="translatePage">
    <textarea id="speech-text" name="text" cols="1" rows="1" style="display:none;"></textarea>
    <img onclick="startDictation()" src="https://i.ibb.co/4Ts8Nqp/d8c7164a-dede-4f8a-b968-4e41f110a4ac-200x200.png"/>
    <input id="translate" class="btn btn-outline-secondary btn-sm" type="submit" value="Translate" style="width: 100px; height: 100px;"/>
</form>
<textarea id="translated" cols="100" rows="10" style="display:none;">{{ translated }}</textarea>
<script src="https://code.responsivevoice.org/responsivevoice.js?key=qNPkUHT3"></script>
<script>
    const $translate = document.getElementById('translates');
    {{#if speak}}
        const text = document.getElementById('translated').value;
        responsiveVoice.speak(text);    
    {{/if}}
    
</script>

<script>
    let lang = "pt-PT";
    function startDictation() {
        if (window.hasOwnProperty('webkitSpeechRecognition')) {
        var recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
    
        recognition.lang = lang;
        recognition.start();
        recognition.onresult = function(e) {
            const $speechT = document.getElementById("speech-text");
            $speechT.value = e.results[0][0].transcript;
            recognition.stop();
        };
        recognition.onerror = function(e) {
            recognition.stop();
        }
        }
    }
</script>